# 子应用 - 挂载 - FastAPI

如果您需要拥有两个独立的 FastAPI 应用程序,它们各自拥有独立的 OpenAPI 和文档 UI,您可以拥有一个主应用程序并"挂载"一个(或多个)子应用程序.

## 挂载 FastAPI 应用程序

"挂载"意味着在特定路径中添加一个完全"独立"的应用程序,然后该应用程序负责处理该路径下的所有内容,使用在子应用程序中声明的路径操作.

### 顶层应用程序

首先,创建主顶层 FastAPI 应用程序及其路径操作:

Python 3.8+

```python
from fastapi import FastAPI

app = FastAPI()

@app.get("/app")
def read_main():
    return {"message": "Hello World from main app"}

subapi = FastAPI()

@subapi.get("/sub")
def read_sub():
    return {"message": "Hello World from sub API"}

app.mount("/subapi", subapi)
```

### 子应用程序

然后,创建您的子应用程序及其路径操作.

这个子应用程序只是另一个标准的 FastAPI 应用程序,但这是将被"挂载"的应用程序:

Python 3.8+

```python
from fastapi import FastAPI

app = FastAPI()

@app.get("/app")
def read_main():
    return {"message": "Hello World from main app"}

subapi = FastAPI()

@subapi.get("/sub")
def read_sub():
    return {"message": "Hello World from sub API"}

app.mount("/subapi", subapi)
```

### 挂载子应用程序

在您的顶层应用程序 `app` 中,挂载子应用程序 `subapi`.

在这种情况下,它将被挂载在路径 `/subapi` 上:

Python 3.8+

```python
from fastapi import FastAPI

app = FastAPI()

@app.get("/app")
def read_main():
    return {"message": "Hello World from main app"}

subapi = FastAPI()

@subapi.get("/sub")
def read_sub():
    return {"message": "Hello World from sub API"}

app.mount("/subapi", subapi)
```

### 检查自动 API 文档

现在,使用您的文件运行 `fastapi` 命令:

```bash
$ fastapi dev main.py

<span style="color: green;">INFO</span>:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
```

并在 http://127.0.0.1:8000/docs 打开文档.

您将看到主应用程序的自动 API 文档,仅包含其自己的路径操作:

![主应用文档界面](https://fastapi.tiangolo.com/img/tutorial/sub-applications/image01.png)

然后,在 http://127.0.0.1:8000/subapi/docs 打开子应用程序的文档.

您将看到子应用程序的自动 API 文档,仅包含其自己的路径操作,所有这些都在正确的子路径前缀 `/subapi` 下:

![子应用文档界面](https://fastapi.tiangolo.com/img/tutorial/sub-applications/image02.png)

如果您尝试与这两个用户界面中的任何一个进行交互,它们将正常工作,因为浏览器将能够与每个特定的应用程序或子应用程序通信.

### 技术细节:`root_path`

当您按照上述方式挂载子应用程序时,FastAPI 将负责使用 ASGI 规范中称为 `root_path` 的机制向子应用程序传达挂载路径.

这样,子应用程序将知道为文档 UI 使用该路径前缀.

子应用程序也可以有自己的挂载子应用程序,一切都会正常工作,因为 FastAPI 会自动处理所有这些 `root_path`.

您将在关于"代理服务器后"的部分中了解更多关于 `root_path` 以及如何显式使用它.