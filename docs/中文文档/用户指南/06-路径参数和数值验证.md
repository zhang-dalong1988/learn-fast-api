# 路径参数和数值验证

## 1. 导入 Path

```python
# 导入 FastAPI 和 Path 类
from fastapi import FastAPI, Path

# 创建应用实例
app = FastAPI()


# 定义路径操作, 使用 Path 添加元数据
@app.get("/items/{item_id}")
async def read_items(
    # item_id 是路径参数, 使用 Path 添加标题
    item_id: int = Path(..., title="The ID of the item to get"),
):
    # 返回包含 item_id 的结果
    results = {"item_id": item_id}
    return results
```

## 2. 参数顺序很重要

当你使用 `Path` 声明必填路径参数时, 参数的顺序很重要。

如果你有这样的函数:

```python
# 导入 FastAPI 和 Path 类
from fastapi import FastAPI, Path

# 创建应用实例
app = FastAPI()


# 定义路径操作, 但参数顺序有问题
@app.get("/items/{item_id}")
async def read_items(
    item_id: int = Path(..., title="The ID of the item to get"),
    name: str | None = None,  # Python 会抱怨
):
    # 返回结果
    results = {"item_id": item_id}
    if name:
        results.update({"name": name})
    return results
```

Python 会抱怨 `name` 有默认值但 `item_id` 不在它之前。

你可以通过重新排序参数, 或使用 `*` 技巧来解决这个问题:

```python
# 导入 FastAPI 和 Path 类
from fastapi import FastAPI, Path

# 创建应用实例
app = FastAPI()


# 定义路径操作, 使用 * 解决顺序问题
@app.get("/items/{item_id}")
async def read_items(
    *,  # 这个 * 告诉 Python 后面的参数必须是关键字参数
    item_id: int = Path(..., title="The ID of the item to get"),
    name: str | None = None,
):
    # 返回结果
    results = {"item_id": item_id}
    if name:
        results.update({"name": name})
    return results
```

## 3. 数值验证

你可以声明数值约束:

```python
# 导入 FastAPI 和 Path 类
from fastapi import FastAPI, Path

# 创建应用实例
app = FastAPI()


# 定义路径操作, 添加数值验证
@app.get("/items/{item_id}")
async def read_items(
    # item_id 必须大于 0 且小于等于 100
    item_id: int = Path(..., gt=0, le=100),
):
    # 返回结果
    results = {"item_id": item_id}
    return results
```

参数 `gt`, `le` 是:
- `gt`: 大于 (greater than)
- `le`: 小于等于 (less than or equal)

你也可以使用:
- `lt`: 小于 (less than)
- `ge`: 大于等于 (greater than or equal)

## 4. 总结

使用 `Path` 你可以:

* 为路径参数声明元数据
* 声明数值验证, 如 `gt`, `ge`, `lt`, `le`
* 使用 `*` 技巧处理参数顺序

以及更多!
