# 静态文件

你可以使用 `StaticFiles` 从目录自动提供静态文件。

## 1. 使用 `StaticFiles`

- 导入 `StaticFiles`。
- 在特定路径中 "挂载" 一个 `StaticFiles()` 实例。

**Python 3.8+**

```python
# 从 fastapi 导入 FastAPI
from fastapi import FastAPI
# 从 fastapi.staticfiles 导入 StaticFiles
# StaticFiles 用于提供静态文件服务
from fastapi.staticfiles import StaticFiles

# 创建 FastAPI 应用实例
app = FastAPI()

# 挂载静态文件服务
# 参数说明:
# - "/static": URL 路径前缀, 访问静态文件时需要使用此前缀
# - StaticFiles(directory="static"): 指定静态文件所在的目录名
# - name="static": 给这个挂载的应用一个内部名称, 供 FastAPI 内部使用
app.mount("/static", StaticFiles(directory="static"), name="static")
```

### 技术细节

你也可以使用 `from starlette.staticfiles import StaticFiles`。

__FastAPI__ 将相同的 `starlette.staticfiles` 作为 `fastapi.staticfiles` 提供, 只是为了方便你, 开发者。但它实际上直接来自 Starlette。

### 1.1 什么是 "挂载"

"挂载" 意味着在特定路径中添加一个完整的 "独立" 应用程序, 该应用程序然后负责处理所有子路径。

这与使用 `APIRouter` 不同, 因为挂载的应用程序是完全独立的。你的主应用程序的 OpenAPI 和文档不会包含挂载的应用程序的任何内容等。

你可以在高级用户指南中阅读更多相关信息。

## 2. 详细说明

第一个 `"/static"` 指的是这个 "子应用程序" 将被 "挂载" 的子路径。因此, 任何以 `"/static"` 开头的路径都将由它处理。

`directory="static"` 指的是包含你的静态文件的目录名称。

`name="static"` 给它一个可以在 __FastAPI__ 内部使用的名称。

所有这些参数都可以与 "`static`" 不同, 根据你自己应用程序的需求和具体细节进行调整。

例如, 如果你有以下目录结构:

```
my_project/
├── main.py          # FastAPI 应用文件
├── static/          # 静态文件目录
│   ├── css/
│   │   └── style.css
│   ├── js/
│   │   └── script.js
│   └── images/
│       └── logo.png
└── ...
```

使用 `app.mount("/static", StaticFiles(directory="static"), name="static")` 后, 你可以通过以下 URL 访问这些文件:

- CSS: `http://localhost:8000/static/css/style.css`
- JS: `http://localhost:8000/static/js/script.js`
- 图片: `http://localhost:8000/static/images/logo.png`

### 2.1 使用不同的路径和目录

你可以根据需要自定义挂载路径和目录名称:

**Python 3.8+**

```python
from fastapi import FastAPI
from fastapi.staticfiles import StaticFiles

app = FastAPI()

# 自定义挂载路径和目录
# 这里的 URL 路径是 /assets, 但目录名是 public
app.mount("/assets", StaticFiles(directory="public"), name="assets")

# 你可以挂载多个静态文件目录
app.mount("/uploads", StaticFiles(directory="uploaded_files"), name="uploads")
```

### 2.2 在 HTML 中使用

在 HTML 模板中, 你可以使用 `url_for` 来生成静态文件的 URL:

**Python 3.8+**

```python
from fastapi import FastAPI, Request
from fastapi.staticfiles import StaticFiles
from fastapi.templating import Jinja2Templates

app = FastAPI()

# 挂载静态文件
app.mount("/static", StaticFiles(directory="static"), name="static")

templates = Jinja2Templates(directory="templates")

@app.get("/")
async def read_root(request: Request):
    # 在模板中使用 url_for 生成静态文件 URL
    return templates.TemplateResponse("index.html", {
        "request": request,
        "css_url": "/static/css/style.css",  # 或使用 request.url_for("static", path="/css/style.css")
    })
```

**index.html**:

```html
<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="{{ css_url }}">
</head>
<body>
    <h1>Hello FastAPI</h1>
</body>
</html>
```

## 3. 更多信息

有关更多详细信息和选项, 请查看 Starlette 关于静态文件的文档。
