# 16. 响应状态码

与指定响应模型类似，你也可以在任何路径操作中使用 `status_code` 参数来声明响应所使用的 HTTP 状态码：

- `@app.get()`
- `@app.post()`
- `@app.put()`
- `@app.delete()`
- 等等

```python
# 从 fastapi 导入 FastAPI 类
from fastapi import FastAPI

# 创建 FastAPI 应用实例
app = FastAPI()

# 定义一个 POST 路径操作，状态码设置为 201（表示资源已创建）
# status_code 参数是装饰器方法的参数，不是路径操作函数的参数
@app.post("/items/", status_code=201)
async def create_item(name: str):
    # 返回创建的 item 名称
    return {"name": name}
```

Note
请注意，`status_code` 是"装饰器"方法（`get`、`post` 等）的参数，而不是你的路径操作函数的参数，不像其他所有的参数和请求体。

`status_code` 参数接收一个表示 HTTP 状态码的数字。

Info
`status_code` 也可以接收一个 `IntEnum`，例如 Python 的 `http.HTTPStatus`。

这样做会：

- 在响应中返回该状态码。
- 在 OpenAPI 模式中记录该状态码（因此也会显示在用户界面中）：

Note
某些响应码（见下一节）表示响应没有响应体。
FastAPI 知道这一点，并且会生成说明没有响应体的 OpenAPI 文档。

## 16.1. 关于 HTTP 状态码

Note
如果你已经知道什么是 HTTP 状态码，可以跳到下一节。

在 HTTP 中，你发送一个 3 位数字的状态码作为响应的一部分。

这些状态码都有一个关联的名称以便识别，但重要的部分是数字。

简而言之：

- `100 - 199` 用于"信息"响应。你很少直接使用它们。具有这些状态码的响应不能有响应体。
- `200 - 299` 用于"成功"响应。这些是你最常使用的状态码。
  - `200` 是默认的状态码，表示一切"OK"。
  - 另一个例子是 `201`，"已创建"。通常在数据库中创建新记录后使用。
  - 一个特殊情况是 `204`，"无内容"。当没有内容要返回给客户端时使用此响应，因此响应不能有响应体。
- `300 - 399` 用于"重定向"。具有这些状态码的响应可能有也可能没有响应体，除了 `304`，"未修改"，它必须没有响应体。
- `400 - 499` 用于"客户端错误"响应。这些是你可能第二常用的状态码类型。
  - 一个例子是 `404`，用于"未找到"响应。
  - 对于来自客户端的通用错误，你可以直接使用 `400`。
- `500 - 599` 用于服务器错误。你几乎从不直接使用它们。当你的应用程序代码或服务器的某个部分出现问题时，它会自动返回这些状态码之一。

## 16.2. 记忆名称的快捷方式

让我们再看一下之前的例子：

```python
# 从 fastapi 导入 FastAPI 类
from fastapi import FastAPI

# 创建 FastAPI 应用实例
app = FastAPI()

# 定义一个 POST 路径操作，状态码设置为 201（表示资源已创建）
# 201 是"已创建"的状态码
@app.post("/items/", status_code=201)
async def create_item(name: str):
    # 返回创建的 item 名称
    return {"name": name}
```

`201` 是"已创建"的状态码。

但你不需要记住每个代码的含义。

你可以使用 `fastapi.status` 中的便捷变量。

```python
# 从 fastapi 导入 FastAPI 类和 status 模块
from fastapi import FastAPI, status

# 创建 FastAPI 应用实例
app = FastAPI()

# 定义一个 POST 路径操作，使用 status.HTTP_201_CREATED 常量
# 这样更易读，编辑器也会提供自动补全
@app.post("/items/", status_code=status.HTTP_201_CREATED)
async def create_item(name: str):
    # 返回创建的 item 名称
    return {"name": name}
```

这些只是为了方便，它们保存的是相同的数字，但通过这种方式你可以使用编辑器的自动补全功能来找到它们：

Technical Details
你也可以使用 `from starlette import status`。
FastAPI 提供与 `starlette.status` 相同的 `fastapi.status`，只是为了方便你作为开发者使用。但它直接来自 Starlette。

## 16.3. 更改默认值

稍后，在高级用户指南中，你将看到如何返回与在此处声明的默认值不同的状态码。
