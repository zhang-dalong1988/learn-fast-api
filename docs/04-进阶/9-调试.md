# 9-调试

你可以在编辑器中连接调试器，例如使用 Visual Studio Code 或 PyCharm。

## 调用 `uvicorn`

在你的 FastAPI 应用中，直接导入并运行 `uvicorn`：

```python
import uvicorn
from fastapi import FastAPI

app = FastAPI()

@app.get("/")
def root():
    a = "a"
    b = "b" + a
    return {"hello world": b}

if __name__ == "__main__":
    uvicorn.run(app, host="0.0.0.0", port=8000)
```

### 关于 `__name__ == "__main__"`

`__name__ == "__main__"` 的主要目的是让你的文件在以下情况时执行某些代码：

```bash
$ python myapp.py
```

但在其他文件导入它时不执行，像这样：

```python
from myapp import app
```

#### 更多细节

假设你的文件名为 `myapp.py`。

如果你这样运行它：

```bash
$ python myapp.py
```

那么 Python 在你的文件中自动创建的内部变量 `__name__` 的值将是字符串 `"__main__"`。

因此，这部分代码：

```python
    uvicorn.run(app, host="0.0.0.0", port=8000)
```

将会运行。

---

如果你导入该模块（文件），则不会发生这种情况。

所以，如果你有另一个文件 `importer.py`，内容如下：

```python
from myapp import app

# 其他代码
```

在这种情况下，`myapp.py` 中自动创建的变量 `__name__` 的值不会是 `"__main__"`。

因此，这行代码：

```python
    uvicorn.run(app, host="0.0.0.0", port=8000)
```

将不会被执行。

> **提示**
>
> 欲了解更多信息，请查看 Python 官方文档。

## 使用调试器运行代码

因为你直接从代码中运行 Uvicorn 服务器，所以可以直接从调试器调用你的 Python 程序（你的 FastAPI 应用）。

---

例如，在 Visual Studio Code 中，你可以：

- 进入"调试"面板
- 点击"添加配置..."
- 选择"Python"
- 使用"Python: 当前文件（集成终端）"选项运行调试器

然后它会启动服务器并运行你的 FastAPI 代码，在你的断点处停止等等。

它可能看起来像这样：

![Visual Studio Code 调试](https://fastapi.tiangolo.com/img/tutorial/debugging/image01.png)

---

如果你使用 Pycharm，你可以：

- 打开"运行"菜单
- 选择"调试..."选项
- 然后会显示一个上下文菜单
- 选择要调试的文件（在本例中是 `main.py`）

然后它会启动服务器并运行你的 FastAPI 代码，在你的断点处停止等等。

它可能看起来像这样：

![PyCharm 调试](https://fastapi.tiangolo.com/img/tutorial/debugging/image02.png)