# è¯·æ±‚ä½“ - é¢å¤–ç¤ºä¾‹ - FastAPI æ•™ç¨‹

ä½ å¯ä»¥å£°æ˜åº”ç”¨ç¨‹åºå¯ä»¥æ¥æ”¶çš„æ•°æ®ç¤ºä¾‹ã€‚

æœ‰å‡ ç§æ–¹æ³•å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚

## 1. Pydantic æ¨¡å‹ä¸­çš„ç¤ºä¾‹

ä½ å¯ä»¥ä¸º Pydantic æ¨¡å‹å£°æ˜ `examples`ï¼Œè¿™äº›ç¤ºä¾‹å°†è¢«æ·»åŠ åˆ°ç”Ÿæˆçš„ JSON Schema ä¸­ã€‚

### 1.1 Pydantic v2 å’Œ Pydantic v1 çš„åŒºåˆ«

#### Pydantic v2 (æ¨è)

åœ¨ Pydantic ç‰ˆæœ¬ 2 ä¸­ï¼Œä½ å°†ä½¿ç”¨ `model_config` å±æ€§ï¼Œå®ƒæ¥å—ä¸€ä¸ªå­—å…¸ã€‚

ä½ å¯ä»¥è®¾ç½® `"json_schema_extra"`ï¼Œå…¶ä¸­åŒ…å«ä»»ä½•ä½ å¸Œæœ›åœ¨ç”Ÿæˆçš„ JSON Schema ä¸­æ˜¾ç¤ºçš„é¢å¤–æ•°æ®ï¼ŒåŒ…æ‹¬ `examples`ã€‚

```python
from fastapi import FastAPI
from pydantic import BaseModel

app = FastAPI()  # åˆ›å»º FastAPI åº”ç”¨

class Item(BaseModel):
    name: str  # å•†å“åç§°ï¼ˆå¿…éœ€ï¼‰
    description: str | None = None  # å•†å“æè¿°ï¼ˆå¯é€‰ï¼‰
    price: float  # å•†å“ä»·æ ¼ï¼ˆå¿…éœ€ï¼‰
    tax: float | None = None  # ç¨ç‡ï¼ˆå¯é€‰ï¼‰

    model_config = {  # Pydantic v2 é…ç½®æ–¹å¼
        "json_schema_extra": {  # JSON Schema é¢å¤–ä¿¡æ¯
            "examples": [  # ç¤ºä¾‹æ•°æ®åˆ—è¡¨
                {
                    "name": "Foo",  # ç¤ºä¾‹å•†å“åç§°
                    "description": "A very nice Item",  # ç¤ºä¾‹æè¿°
                    "price": 35.4,  # ç¤ºä¾‹ä»·æ ¼
                    "tax": 3.2,  # ç¤ºä¾‹ç¨ç‡
                }
            ]
        }
    }

@app.put("/items/{item_id}")  # PUT è·¯ç”±ç”¨äºæ›´æ–°å•†å“
async def update_item(item_id: int, item: Item):  # item å‚æ•°å°†æ˜¯ Item æ¨¡å‹å®ä¾‹
    results = {"item_id": item_id, "item": item}
    return results
```

#### Pydantic v1

åœ¨ Pydantic ç‰ˆæœ¬ 1 ä¸­ï¼Œä½ å°†ä½¿ç”¨å†…éƒ¨ç±» `Config` å’Œ `schema_extra`ã€‚

ä½ å¯ä»¥è®¾ç½® `schema_extra`ï¼Œå…¶ä¸­åŒ…å«ä»»ä½•ä½ å¸Œæœ›åœ¨ç”Ÿæˆçš„ JSON Schema ä¸­æ˜¾ç¤ºçš„é¢å¤–æ•°æ®ï¼ŒåŒ…æ‹¬ `examples`ã€‚

```python
from fastapi import FastAPI
from pydantic import BaseModel

app = FastAPI()  # åˆ›å»º FastAPI åº”ç”¨

class Item(BaseModel):
    name: str  # å•†å“åç§°ï¼ˆå¿…éœ€ï¼‰
    description: str | None = None  # å•†å“æè¿°ï¼ˆå¯é€‰ï¼‰
    price: float  # å•†å“ä»·æ ¼ï¼ˆå¿…éœ€ï¼‰
    tax: float | None = None  # ç¨ç‡ï¼ˆå¯é€‰ï¼‰

    class Config:  # Pydantic v1 é…ç½®ç±»
        schema_extra = {  # JSON Schema é¢å¤–ä¿¡æ¯
            "examples": [  # ç¤ºä¾‹æ•°æ®åˆ—è¡¨
                {
                    "name": "Foo",  # ç¤ºä¾‹å•†å“åç§°
                    "description": "A very nice Item",  # ç¤ºä¾‹æè¿°
                    "price": 35.4,  # ç¤ºä¾‹ä»·æ ¼
                    "tax": 3.2,  # ç¤ºä¾‹ç¨ç‡
                }
            ]
        }

@app.put("/items/{item_id}")  # PUT è·¯ç”±ç”¨äºæ›´æ–°å•†å“
async def update_item(item_id: int, item: Item):
    results = {"item_id": item_id, "item": item}
    return results
```

**æç¤º**ï¼šä½ å¯ä»¥ä½¿ç”¨ç›¸åŒçš„æŠ€æœ¯æ¥æ‰©å±• JSON Schema å¹¶æ·»åŠ ä½ è‡ªå·±çš„è‡ªå®šä¹‰é¢å¤–ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥æ·»åŠ å‰ç«¯ç”¨æˆ·ç•Œé¢çš„å…ƒæ•°æ®ç­‰ã€‚

**ä¿¡æ¯**ï¼šOpenAPI 3.1.0ï¼ˆè‡ª FastAPI 0.99.0 èµ·ä½¿ç”¨ï¼‰å¢åŠ äº†å¯¹ `examples` çš„æ”¯æŒï¼Œè¿™æ˜¯ JSON Schema æ ‡å‡†çš„ä¸€éƒ¨åˆ†ã€‚åœ¨æ­¤ä¹‹å‰ï¼Œå®ƒåªæ”¯æŒå¸¦æœ‰å•ä¸ªç¤ºä¾‹çš„å…³é”®å­— `example`ã€‚OpenAPI 3.1.0 ä»ç„¶æ”¯æŒå®ƒï¼Œä½†å·²å¼ƒç”¨ï¼Œå¹¶ä¸”ä¸æ˜¯ JSON Schema æ ‡å‡†çš„ä¸€éƒ¨åˆ†ã€‚å› æ­¤ï¼Œé¼“åŠ±ä½ å°† `example` è¿ç§»åˆ° `examples`ã€‚

## 2. Field çš„é™„åŠ å‚æ•°

å½“å°† `Field()` ä¸ Pydantic æ¨¡å‹ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œä½ ä¹Ÿå¯ä»¥å£°æ˜é¢å¤–çš„ `examples`ï¼š

```python
from fastapi import FastAPI
from pydantic import BaseModel, Field  # å¯¼å…¥ Field ç”¨äºå­—æ®µéªŒè¯

app = FastAPI()  # åˆ›å»º FastAPI åº”ç”¨

class Item(BaseModel):
    name: str = Field(examples=["Foo"])  # ä¸º name å­—æ®µæ·»åŠ ç¤ºä¾‹
    description: str | None = Field(
        default=None,
        examples=["A very nice Item"]  # ä¸º description å­—æ®µæ·»åŠ ç¤ºä¾‹
    )
    price: float = Field(examples=[35.4])  # ä¸º price å­—æ®µæ·»åŠ ç¤ºä¾‹
    tax: float | None = Field(
        default=None,
        examples=[3.2]  # ä¸º tax å­—æ®µæ·»åŠ ç¤ºä¾‹
    )

@app.put("/items/{item_id}")  # PUT è·¯ç”±ç”¨äºæ›´æ–°å•†å“
async def update_item(item_id: int, item: Item):
    results = {"item_id": item_id, "item": item}
    return results
```

## 3. JSON Schema ä¸­çš„ `examples` - OpenAPI

å½“ä½¿ç”¨ä»¥ä¸‹ä»»ä½•å‡½æ•°æ—¶ï¼š
- `Path()`
- `Query()`
- `Header()`
- `Cookie()`
- `Body()`
- `Form()`
- `File()`

ä½ ä¹Ÿå¯ä»¥å£°æ˜ä¸€ç»„åŒ…å«é¢å¤–ä¿¡æ¯çš„ `examples`ï¼Œè¿™äº›ä¿¡æ¯å°†è¢«æ·»åŠ åˆ°å®ƒä»¬åœ¨ OpenAPI å†…éƒ¨çš„ JSON Schemas ä¸­ã€‚

### 3.1 å¸¦æœ‰ `examples` çš„ Body

è¿™é‡Œæˆ‘ä»¬ä¼ é€’ `examples`ï¼ŒåŒ…å« `Body()` ä¸­æœŸæœ›çš„æ•°æ®çš„ä¸€ä¸ªç¤ºä¾‹ï¼š

```python
from typing import Annotated  # Python 3.9+ éœ€è¦ï¼Œ3.10+ å¯é€‰ä½†æ¨è

from fastapi import Body, FastAPI
from pydantic import BaseModel

app = FastAPI()  # åˆ›å»º FastAPI åº”ç”¨

class Item(BaseModel):
    name: str  # å•†å“åç§°ï¼ˆå¿…éœ€ï¼‰
    description: str | None = None  # å•†å“æè¿°ï¼ˆå¯é€‰ï¼‰
    price: float  # å•†å“ä»·æ ¼ï¼ˆå¿…éœ€ï¼‰
    tax: float | None = None  # ç¨ç‡ï¼ˆå¯é€‰ï¼‰

@app.put("/items/{item_id}")  # PUT è·¯ç”±ç”¨äºæ›´æ–°å•†å“
async def update_item(
    item_id: int,  # è·¯å¾„å‚æ•°ï¼šå•†å“ ID
    item: Annotated[  # ä½¿ç”¨ Annotated åŒ…è£… Item
        Item,
        Body(
            examples=[  # Body çš„ç¤ºä¾‹æ•°æ®
                {
                    "name": "Foo",  # ç¤ºä¾‹å•†å“åç§°
                    "description": "A very nice Item",  # ç¤ºä¾‹æè¿°
                    "price": 35.4,  # ç¤ºä¾‹ä»·æ ¼
                    "tax": 3.2,  # ç¤ºä¾‹ç¨ç‡
                }
            ],
        ),
    ],
):
    results = {"item_id": item_id, "item": item}
    return results
```

**æç¤º**ï¼šå¦‚æœå¯èƒ½ï¼Œä¼˜å…ˆä½¿ç”¨ `Annotated` ç‰ˆæœ¬ã€‚

### 3.2 æ–‡æ¡£ UI ä¸­çš„ç¤ºä¾‹

ä½¿ç”¨ä¸Šè¿°ä»»ä½•æ–¹æ³•ï¼Œå®ƒåœ¨ `/docs` ä¸­çœ‹èµ·æ¥éƒ½æ˜¯è¿™æ ·çš„ï¼š
ï¼ˆè¿™é‡Œä¼šæ˜¾ç¤ºä¸€ä¸ªæˆªå›¾ï¼Œå±•ç¤ºæ–‡æ¡£ UI ä¸­çš„ç¤ºä¾‹ï¼‰

### 3.3 å¸¦æœ‰å¤šä¸ª `examples` çš„ Body

ä½ å½“ç„¶ä¹Ÿå¯ä»¥ä¼ é€’å¤šä¸ª `examples`ï¼š

```python
from typing import Annotated

from fastapi import Body, FastAPI
from pydantic import BaseModel

app = FastAPI()  # åˆ›å»º FastAPI åº”ç”¨

class Item(BaseModel):
    name: str  # å•†å“åç§°ï¼ˆå¿…éœ€ï¼‰
    description: str | None = None  # å•†å“æè¿°ï¼ˆå¯é€‰ï¼‰
    price: float  # å•†å“ä»·æ ¼ï¼ˆå¿…éœ€ï¼‰
    tax: float | None = None  # ç¨ç‡ï¼ˆå¯é€‰ï¼‰

@app.put("/items/{item_id}")  # PUT è·¯ç”±ç”¨äºæ›´æ–°å•†å“
async def update_item(
    *,  # å¼ºåˆ¶åç»­å‚æ•°ä¸ºå…³é”®å­—å‚æ•°
    item_id: int,  # è·¯å¾„å‚æ•°ï¼šå•†å“ ID
    item: Annotated[  # ä½¿ç”¨ Annotated åŒ…è£… Item
        Item,
        Body(
            examples=[  # å¤šä¸ªç¤ºä¾‹æ•°æ®
                {  # ç¬¬ä¸€ä¸ªç¤ºä¾‹ï¼šå®Œæ•´æ•°æ®
                    "name": "Foo",
                    "description": "A very nice Item",
                    "price": 35.4,
                    "tax": 3.2,
                },
                {  # ç¬¬äºŒä¸ªç¤ºä¾‹ï¼šå­—ç¬¦ä¸²ä»·æ ¼
                    "name": "Bar",
                    "price": "35.4",  # å­—ç¬¦ä¸²ç±»å‹çš„ä»·æ ¼
                },
                {  # ç¬¬ä¸‰ä¸ªç¤ºä¾‹ï¼šæ— æ•ˆæ•°æ®
                    "name": "Baz",
                    "price": "thirty five point four",  # æ–‡å­—ä»·æ ¼ï¼ˆä¼šéªŒè¯å¤±è´¥ï¼‰
                },
            ],
        ),
    ],
):
    results = {"item_id": item_id, "item": item}
    return results
```

å½“ä½ è¿™æ ·åšæ—¶ï¼Œç¤ºä¾‹å°†æˆä¸ºè¯¥æ­£æ–‡æ•°æ®çš„å†…éƒ¨ JSON Schema çš„ä¸€éƒ¨åˆ†ã€‚ç„¶è€Œï¼Œåœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼ŒSwagger UIï¼ˆè´Ÿè´£æ˜¾ç¤ºæ–‡æ¡£ UI çš„å·¥å…·ï¼‰ä¸æ”¯æŒåœ¨ JSON Schema ä¸­æ˜¾ç¤ºæ•°æ®çš„å¤šä¸ªç¤ºä¾‹ã€‚ä½†è¯·é˜…è¯»ä¸‹é¢çš„è§£å†³æ–¹æ³•ã€‚

### 3.4 OpenAPI ç‰¹å®šçš„ `examples`

åœ¨ JSON Schema æ”¯æŒ `examples` ä¹‹å‰ï¼ŒOpenAPI å·²ç»æ”¯æŒä¸€ä¸ªä¹Ÿç§°ä¸º `examples` çš„ä¸åŒå­—æ®µã€‚

è¿™ä¸ª OpenAPI ç‰¹å®šçš„ `examples` æ”¾åœ¨ OpenAPI è§„èŒƒçš„å¦ä¸€ä¸ªéƒ¨åˆ†ä¸­ã€‚å®ƒæ”¾åœ¨æ¯ä¸ªè·¯å¾„æ“ä½œçš„è¯¦ç»†ä¿¡æ¯ä¸­ï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸ª JSON Schema å†…éƒ¨ã€‚

Swagger UI å·²ç»æ”¯æŒè¿™ä¸ªç‰¹å®šçš„ `examples` å­—æ®µä¸€æ®µæ—¶é—´äº†ã€‚å› æ­¤ï¼Œä½ å¯ä»¥ç”¨å®ƒæ¥åœ¨æ–‡æ¡£ UI ä¸­æ˜¾ç¤ºä¸åŒçš„ç¤ºä¾‹ã€‚

è¿™ä¸ª OpenAPI ç‰¹å®šå­—æ®µ `examples` çš„å½¢çŠ¶æ˜¯ä¸€ä¸ªåŒ…å«å¤šä¸ªç¤ºä¾‹çš„å­—å…¸ï¼ˆè€Œä¸æ˜¯åˆ—è¡¨ï¼‰ï¼Œæ¯ä¸ªç¤ºä¾‹éƒ½åŒ…å«å°†æ·»åŠ åˆ° OpenAPI çš„é¢å¤–ä¿¡æ¯ã€‚

å®ƒä¸ä¼šè¿›å…¥ OpenAPI ä¸­åŒ…å«çš„æ¯ä¸ª JSON Schema å†…éƒ¨ï¼Œè€Œæ˜¯æ”¾åœ¨å¤–éƒ¨ï¼Œç›´æ¥åœ¨è·¯å¾„æ“ä½œä¸­ã€‚

### 3.5 ä½¿ç”¨ `openapi_examples` å‚æ•°

ä½ å¯ä»¥ä½¿ç”¨ `openapi_examples` å‚æ•°åœ¨ FastAPI ä¸­å£°æ˜ OpenAPI ç‰¹å®šçš„ `examples`ï¼Œç”¨äºï¼š
- `Path()`
- `Query()`
- `Header()`
- `Cookie()`
- `Body()`
- `Form()`
- `File()`

å­—å…¸çš„é”®æ ‡è¯†æ¯ä¸ªç¤ºä¾‹ï¼Œæ¯ä¸ªå€¼æ˜¯å¦ä¸€ä¸ªå­—å…¸ã€‚

`examples` ä¸­çš„æ¯ä¸ªç‰¹å®šç¤ºä¾‹ `dict` å¯ä»¥åŒ…å«ï¼š
- `summary`ï¼šç¤ºä¾‹çš„ç®€çŸ­æè¿°ã€‚
- `description`ï¼šå¯ä»¥åŒ…å« Markdown æ–‡æœ¬çš„é•¿æè¿°ã€‚
- `value`ï¼šè¿™æ˜¯æ˜¾ç¤ºçš„å®é™…ç¤ºä¾‹ï¼Œä¾‹å¦‚ `dict`ã€‚
- `externalValue`ï¼š`value` çš„æ›¿ä»£æ–¹æ¡ˆï¼ŒæŒ‡å‘ç¤ºä¾‹çš„ URLã€‚è™½ç„¶è¿™å¯èƒ½ä¸åƒ `value` é‚£æ ·è¢«è®¸å¤šå·¥å…·æ”¯æŒã€‚

ä½ å¯ä»¥åƒè¿™æ ·ä½¿ç”¨å®ƒï¼š

```python
from typing import Annotated

from fastapi import Body, FastAPI
from pydantic import BaseModel

app = FastAPI()  # åˆ›å»º FastAPI åº”ç”¨

class Item(BaseModel):
    name: str  # å•†å“åç§°ï¼ˆå¿…éœ€ï¼‰
    description: str | None = None  # å•†å“æè¿°ï¼ˆå¯é€‰ï¼‰
    price: float  # å•†å“ä»·æ ¼ï¼ˆå¿…éœ€ï¼‰
    tax: float | None = None  # ç¨ç‡ï¼ˆå¯é€‰ï¼‰

@app.put("/items/{item_id}")  # PUT è·¯ç”±ç”¨äºæ›´æ–°å•†å“
async def update_item(
    *,  # å¼ºåˆ¶åç»­å‚æ•°ä¸ºå…³é”®å­—å‚æ•°
    item_id: int,  # è·¯å¾„å‚æ•°ï¼šå•†å“ ID
    item: Annotated[  # ä½¿ç”¨ Annotated åŒ…è£… Item
        Item,
        Body(
            openapi_examples={  # OpenAPI ç‰¹å®šçš„ç¤ºä¾‹é…ç½®
                "normal": {  # ç¬¬ä¸€ä¸ªç¤ºä¾‹ï¼šæ­£å¸¸æ•°æ®
                    "summary": "A normal example",  # ç®€çŸ­æ ‡é¢˜
                    "description": "A **normal** item works correctly.",  # æ”¯æŒ Markdown çš„æè¿°
                    "value": {  # å®é™…ç¤ºä¾‹å€¼
                        "name": "Foo",
                        "description": "A very nice Item",
                        "price": 35.4,
                        "tax": 3.2,
                    },
                },
                "converted": {  # ç¬¬äºŒä¸ªç¤ºä¾‹ï¼šç±»å‹è½¬æ¢
                    "summary": "An example with converted data",
                    "description": "FastAPI can convert price `strings` to actual `numbers` automatically",
                    "value": {
                        "name": "Bar",
                        "price": "35.4",  # å­—ç¬¦ä¸²ä¼šè¢«è‡ªåŠ¨è½¬æ¢ä¸ºæ•°å­—
                    },
                },
                "invalid": {  # ç¬¬ä¸‰ä¸ªç¤ºä¾‹ï¼šæ— æ•ˆæ•°æ®
                    "summary": "Invalid data is rejected with an error",
                    "value": {
                        "name": "Baz",
                        "price": "thirty five point four",  # æ— æ³•è½¬æ¢ä¸ºæ•°å­—ï¼Œä¼šè¿”å›é”™è¯¯
                    },
                },
            },
        ),
    ],
):
    results = {"item_id": item_id, "item": item}
    return results
```

**æç¤º**ï¼šå¦‚æœå¯èƒ½ï¼Œä¼˜å…ˆä½¿ç”¨ `Annotated` ç‰ˆæœ¬ã€‚

### 3.6 æ–‡æ¡£ UI ä¸­çš„ OpenAPI ç¤ºä¾‹

å°† `openapi_examples` æ·»åŠ åˆ° `Body()` åï¼Œ`/docs` å°†å¦‚ä¸‹æ‰€ç¤ºï¼š
ï¼ˆè¿™é‡Œä¼šæ˜¾ç¤ºä¸€ä¸ªæˆªå›¾ï¼Œå±•ç¤ºæ–‡æ¡£ UI ä¸­çš„å¤šä¸ªç¤ºä¾‹ï¼‰

## 4. æŠ€æœ¯ç»†èŠ‚

**æç¤º**ï¼šå¦‚æœä½ å·²ç»åœ¨ä½¿ç”¨ FastAPI ç‰ˆæœ¬ 0.99.0 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œä½ å¯èƒ½å¯ä»¥è·³è¿‡è¿™äº›ç»†èŠ‚ã€‚å®ƒä»¬å¯¹äº OpenAPI 3.1.0 ä¸å¯ç”¨çš„æ—§ç‰ˆæœ¬æ›´ç›¸å…³ã€‚ä½ å¯ä»¥å°†æ­¤è§†ä¸ºç®€çŸ­çš„ OpenAPI å’Œ JSON Schema å†å²è¯¾ã€‚ğŸ¤“

**è­¦å‘Š**ï¼šè¿™äº›æ˜¯å…³äºæ ‡å‡† JSON Schema å’Œ OpenAPI çš„éå¸¸æŠ€æœ¯æ€§çš„ç»†èŠ‚ã€‚å¦‚æœä¸Šè¿°æ€è·¯å·²ç»å¯¹ä½ æœ‰æ•ˆï¼Œé‚£å¯èƒ½å°±è¶³å¤Ÿäº†ï¼Œä½ å¯èƒ½ä¸éœ€è¦è¿™äº›ç»†èŠ‚ï¼Œå¯ä»¥éšæ—¶è·³è¿‡å®ƒä»¬ã€‚

### 4.1 JSON Schema çš„ `examples` å­—æ®µ

åœ¨ OpenAPI 3.1.0 ä¹‹å‰ï¼ŒOpenAPI ä½¿ç”¨äº† JSON Schema çš„ä¸€ä¸ªæ—§çš„å’Œä¿®æ”¹è¿‡çš„ç‰ˆæœ¬ã€‚JSON Schema æ²¡æœ‰ `examples`ï¼Œæ‰€ä»¥ OpenAPI åœ¨è‡ªå·±çš„ä¿®æ”¹ç‰ˆæœ¬ä¸­æ·»åŠ äº†è‡ªå·±çš„ `example` å­—æ®µã€‚

OpenAPI è¿˜åœ¨è§„èŒƒçš„å…¶ä»–éƒ¨åˆ†æ·»åŠ äº† `example` å’Œ `examples` å­—æ®µï¼š
- åœ¨è§„èŒƒä¸­ä½¿ç”¨çš„ `Parameter Object`ï¼Œè¢« FastAPI çš„ `Path()`ã€`Query()`ã€`Header()`ã€`Cookie()` ä½¿ç”¨
- åœ¨è§„èŒƒä¸­ä½¿ç”¨çš„ `Request Body Object`ï¼Œåœ¨å­—æ®µ `content` ä¸­ï¼Œåœ¨ `Media Type Object` ä¸Šï¼Œè¢« FastAPI çš„ `Body()`ã€`File()`ã€`Form()` ä½¿ç”¨

**ä¿¡æ¯**ï¼šè¿™ä¸ªæ—§çš„ OpenAPI ç‰¹å®šçš„ `examples` å‚æ•°ç°åœ¨æ˜¯ `openapi_examples`ï¼Œè‡ª FastAPI 0.103.0 èµ·ã€‚

### 4.2 Pydantic å’Œ FastAPI `examples`

å½“ä½ åœ¨ Pydantic æ¨¡å‹å†…éƒ¨æ·»åŠ  `examples` æ—¶ï¼Œä½¿ç”¨ `schema_extra` æˆ– `Field(examples=["something"])`ï¼Œè¯¥ç¤ºä¾‹è¢«æ·»åŠ åˆ°è¯¥ Pydantic æ¨¡å‹çš„ JSON Schema ä¸­ã€‚

è€Œè¯¥ Pydantic æ¨¡å‹çš„ JSON Schema åŒ…å«åœ¨ä½ çš„ API çš„ OpenAPI ä¸­ï¼Œç„¶ååœ¨æ–‡æ¡£ UI ä¸­ä½¿ç”¨ã€‚

åœ¨ FastAPI 0.99.0 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼ˆ0.99.0 åŠä»¥ä¸Šä½¿ç”¨è¾ƒæ–°çš„ OpenAPI 3.1.0ï¼‰ï¼Œå½“ä½ å°† `example` æˆ– `examples` ä¸ä»»ä½•å…¶ä»–å®ç”¨ç¨‹åºï¼ˆ`Query()`ã€`Body()` ç­‰ï¼‰ä¸€èµ·ä½¿ç”¨æ—¶ï¼Œè¿™äº›ç¤ºä¾‹æ²¡æœ‰è¢«æ·»åŠ åˆ°æè¿°è¯¥æ•°æ®çš„ JSON Schema ä¸­ï¼ˆç”šè‡³æ²¡æœ‰è¢«æ·»åŠ åˆ° OpenAPI è‡ªå·±çš„ JSON Schema ç‰ˆæœ¬ä¸­ï¼‰ï¼Œå®ƒä»¬è¢«ç›´æ¥æ·»åŠ åˆ° OpenAPI ä¸­çš„è·¯å¾„æ“ä½œå£°æ˜ä¸­ï¼ˆåœ¨ OpenAPI ä½¿ç”¨ JSON Schema çš„éƒ¨åˆ†ä¹‹å¤–ï¼‰ã€‚

ä½†ç°åœ¨ FastAPI 0.99.0 åŠä»¥ä¸Šä½¿ç”¨ OpenAPI 3.1.0ï¼Œä½¿ç”¨ JSON Schema 2020-12ï¼ŒSwagger UI 5.0.0 åŠä»¥ä¸Šï¼Œä¸€åˆ‡éƒ½æ›´åŠ ä¸€è‡´ï¼Œç¤ºä¾‹åŒ…å«åœ¨ JSON Schema ä¸­ã€‚

### 4.3 Swagger UI å’Œ OpenAPI ç‰¹å®šçš„ `examples`

ç°åœ¨ï¼Œç”±äº Swagger UI ä¸æ”¯æŒå¤šä¸ª JSON Schema ç¤ºä¾‹ï¼ˆæˆªè‡³ 2023-08-26ï¼‰ï¼Œç”¨æˆ·æ— æ³•åœ¨æ–‡æ¡£ä¸­æ˜¾ç¤ºå¤šä¸ªç¤ºä¾‹ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒFastAPI 0.103.0 å¢åŠ äº†å¯¹ä½¿ç”¨æ–°å‚æ•° `openapi_examples` å£°æ˜ç›¸åŒçš„æ—§ OpenAPI ç‰¹å®š `examples` å­—æ®µçš„æ”¯æŒã€‚ğŸ¤“

## 5. æ€»ç»“

ç®€è€Œè¨€ä¹‹ï¼Œå‡çº§åˆ° FastAPI 0.99.0 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œäº‹æƒ…ä¼šç®€å•ã€ä¸€è‡´å’Œç›´è§‚å¾—å¤šï¼Œä½ ä¸å¿…äº†è§£æ‰€æœ‰è¿™äº›å†å²ç»†èŠ‚ã€‚ğŸ˜

### ä¸»è¦è¦ç‚¹ï¼š

1. **Pydantic æ¨¡å‹ç¤ºä¾‹**ï¼š
   - v2 ä½¿ç”¨ `model_config` å’Œ `json_schema_extra`
   - v1 ä½¿ç”¨å†…éƒ¨ `Config` ç±»å’Œ `schema_extra`

2. **Field ç¤ºä¾‹**ï¼š
   - ä½¿ç”¨ `Field(examples=[...])` ä¸ºæ¯ä¸ªå­—æ®µæ·»åŠ ç¤ºä¾‹

3. **Body ç¤ºä¾‹**ï¼š
   - ä½¿ç”¨ `Body(examples=[...])` æ·»åŠ ç®€å•ç¤ºä¾‹
   - ä½¿ç”¨ `Body(openapi_examples={...})` æ·»åŠ å¸¦æœ‰ä¸°å¯Œä¿¡æ¯çš„å¤šä¸ªç¤ºä¾‹

4. **ç‰ˆæœ¬å»ºè®®**ï¼š
   - ä½¿ç”¨ FastAPI 0.99.0+ è·å¾—æ›´å¥½çš„æ”¯æŒ
   - ä¼˜å…ˆä½¿ç”¨ `Annotated` è¯­æ³•
   - ä½¿ç”¨ `openapi_examples` åœ¨æ–‡æ¡£ UI ä¸­æ˜¾ç¤ºå¤šä¸ªç¤ºä¾‹