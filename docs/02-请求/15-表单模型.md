# è¡¨å•æ¨¡å‹

æ‚¨å¯ä»¥åœ¨ FastAPI ä¸­ä½¿ç”¨ **Pydantic æ¨¡å‹** æ¥å£°æ˜**è¡¨å•å­—æ®µ**.

> **æ³¨æ„**
>
> è‡ª FastAPI `0.113.0` ç‰ˆæœ¬èµ·æ”¯æŒæ­¤åŠŸèƒ½.ğŸ¤“

## ç”¨äºè¡¨å•çš„ Pydantic æ¨¡å‹

æ‚¨åªéœ€å£°æ˜ä¸€ä¸ªåŒ…å«æ‚¨å¸Œæœ›ä½œä¸º**è¡¨å•å­—æ®µ**æ¥æ”¶çš„å­—æ®µçš„ **Pydantic æ¨¡å‹**,ç„¶åå°†å‚æ•°å£°æ˜ä¸º `Form` å³å¯.

### Python 3.9+

```python
from typing import Annotated

from fastapi import FastAPI, Form
from pydantic import BaseModel

app = FastAPI()

class FormData(BaseModel):
    username: str
    password: str

@app.post("/login/")
async def login(data: Annotated[FormData, Form()]):
    return data
```

> ğŸ¤“ å…¶ä»–ç‰ˆæœ¬å’Œå˜ä½“

#### Python 3.8+ - é Annotated

```python
from fastapi import FastAPI, Form
from pydantic import BaseModel
from typing_extensions import Annotated

app = FastAPI()

class FormData(BaseModel):
    username: str
    password: str

@app.post("/login/")
async def login(data: Annotated[FormData, Form()]):
    return data
```

> **æç¤º**
>
> å¦‚æœå¯èƒ½,è¯·ä¼˜å…ˆä½¿ç”¨ `Annotated` ç‰ˆæœ¬.

#### Python 3.8+ - ä¸ä½¿ç”¨ Annotated

```python
from fastapi import FastAPI, Form
from pydantic import BaseModel

app = FastAPI()

class FormData(BaseModel):
    username: str
    password: str

@app.post("/login/")
async def login(data: FormData = Form()):
    return data
```

**FastAPI** å°†ä»è¯·æ±‚çš„**è¡¨å•æ•°æ®**ä¸­ä¸º**æ¯ä¸ªå­—æ®µ** **æå–**æ•°æ®,å¹¶æä¾›æ‚¨å®šä¹‰çš„ Pydantic æ¨¡å‹.

## æŸ¥çœ‹æ–‡æ¡£

æ‚¨å¯ä»¥åœ¨ `/docs` çš„æ–‡æ¡£ UI ä¸­è¿›è¡ŒéªŒè¯.

![è¡¨å•æ¨¡å‹æ–‡æ¡£ç•Œé¢](https://fastapi.tiangolo.com/img/tutorial/request-form-models/image01.png)

## ç¦ç”¨é¢å¤–çš„è¡¨å•å­—æ®µ

åœ¨ä¸€äº›ç‰¹æ®Šç”¨ä¾‹ä¸­(å¯èƒ½ä¸å¸¸è§),æ‚¨å¯èƒ½å¸Œæœ›å°†è¡¨å•å­—æ®µ**é™åˆ¶**ä¸ºä»…åœ¨ Pydantic æ¨¡å‹ä¸­å£°æ˜çš„é‚£äº›å­—æ®µ,å¹¶**ç¦æ­¢**ä»»ä½•**é¢å¤–**å­—æ®µ.

> **æ³¨æ„**
>
> è‡ª FastAPI `0.114.0` ç‰ˆæœ¬èµ·æ”¯æŒæ­¤åŠŸèƒ½.ğŸ¤“

ä½ å¯ä»¥ä½¿ç”¨ Pydantic çš„æ¨¡å‹é…ç½®æ¥ `forbid` ä»»ä½• `extra` å­—æ®µ

### Python 3.9+

```python
from typing import Annotated

from fastapi import FastAPI, Form
from pydantic import BaseModel

app = FastAPI()

class FormData(BaseModel):
    username: str
    password: str
    model_config = {"extra": "forbid"}

@app.post("/login/")
async def login(data: Annotated[FormData, Form()]):
    return data
```

> ğŸ¤“ å…¶ä»–ç‰ˆæœ¬å’Œå˜ä½“

#### Python 3.8+ - é Annotated

```python
from fastapi import FastAPI, Form
from pydantic import BaseModel
from typing_extensions import Annotated

app = FastAPI()

class FormData(BaseModel):
    username: str
    password: str
    model_config = {"extra": "forbid"}

@app.post("/login/")
async def login(data: Annotated[FormData, Form()]):
    return data
```

> **æç¤º**
>
> å¦‚æœå¯èƒ½,è¯·ä¼˜å…ˆä½¿ç”¨ `Annotated` ç‰ˆæœ¬.

#### Python 3.8+ - ä¸ä½¿ç”¨ Annotated

```python
from fastapi import FastAPI, Form
from pydantic import BaseModel

app = FastAPI()

class FormData(BaseModel):
    username: str
    password: str
    model_config = {"extra": "forbid"}

@app.post("/login/")
async def login(data: FormData = Form()):
    return data
```

å¦‚æœå®¢æˆ·ç«¯å°è¯•å‘é€ä¸€äº›é¢å¤–çš„æ•°æ®,ä»–ä»¬å°†æ”¶åˆ°ä¸€ä¸ª**é”™è¯¯**å“åº”.

ä¾‹å¦‚,å¦‚æœå®¢æˆ·ç«¯å°è¯•å‘é€ä»¥ä¸‹è¡¨å•å­—æ®µ:

- `username`: `Rick`
- `password`: `Portal Gun`
- `extra`: `Mr. Poopybutthole`

ä»–ä»¬å°†æ”¶åˆ°ä¸€ä¸ªé”™è¯¯å“åº”,å‘ŠçŸ¥ä»–ä»¬å­—æ®µ `extra` æ˜¯ä¸å…è®¸çš„.

```json
{
    "detail": [
        {
            "type": "extra_forbidden",
            "loc": ["body", "extra"],
            "msg": "Extra inputs are not permitted",
            "input": "Mr. Poopybutthole"
        }
    ]
}
```

## æ€»ç»“

æ‚¨å¯ä»¥åœ¨ FastAPI ä¸­ä½¿ç”¨ Pydantic æ¨¡å‹æ¥å£°æ˜è¡¨å•å­—æ®µ.ğŸ˜