# 响应状态码

你可以在路径操作中声明 `status_code` 参数。

## 使用 `status_code` 参数

你可以声明 HTTP 状态码：

```python
from typing import Annotated

from fastapi import FastAPI, status

app = FastAPI()

@app.post("/items/", status_code=status.HTTP_201_CREATED)
async def create_item(name: str):
    return {"name": name}
```

## 状态码的好处

- 在响应中包含该状态码
- 在 OpenAPI schema 和自动文档 UI 中记录它

## 可用的状态码

你可以从 `fastapi.status` 导入状态码。

### 常见的状态码

- **100** 和以上是用于"信息性"响应
- **200** 和以上是用于"成功"响应
- **300** 和以上是用于"重定向"
- **400** 和以上是用于"客户端错误"响应
- **500** 和以上是用于"服务器错误"响应

### 一些常见的状态码示例

```python
from fastapi import FastAPI, status

app = FastAPI()

@app.get("/items/", status_code=status.HTTP_200_OK)
async def read_items():
    return [{"item_id": "Foo"}]

@app.post("/items/", status_code=status.HTTP_201_CREATED)
async def create_item(name: str):
    return {"name": name}

@app.put("/items/{item_id}", status_code=status.HTTP_200_OK)
async def update_item(item_id: str, name: str):
    return {"item_id": item_id, "name": name}

@app.delete("/items/{item_id}", status_code=status.HTTP_204_NO_CONTENT)
async def delete_item(item_id: str):
    return
```

## 更多状态码

你可以在 `fastapi.status` 中找到所有状态码：

### 1xx 信息性响应

- `status.HTTP_100_CONTINUE`
- `status.HTTP_101_SWITCHING_PROTOCOLS`
- `status.HTTP_102_PROCESSING`
- `status.HTTP_103_EARLY_HINTS`

### 2xx 成功

- `status.HTTP_200_OK`
- `status.HTTP_201_CREATED`
- `status.HTTP_202_ACCEPTED`
- `status.HTTP_203_NON_AUTHORITATIVE_INFORMATION`
- `status.HTTP_204_NO_CONTENT`
- `status.HTTP_205_RESET_CONTENT`
- `status.HTTP_206_PARTIAL_CONTENT`
- `status.HTTP_207_MULTI_STATUS`
- `status.HTTP_208_ALREADY_REPORTED`
- `status.HTTP_226_IM_USED`

### 3xx 重定向

- `status.HTTP_300_MULTIPLE_CHOICES`
- `status.HTTP_301_MOVED_PERMANENTLY`
- `status.HTTP_302_FOUND`
- `status.HTTP_303_SEE_OTHER`
- `status.HTTP_304_NOT_MODIFIED`
- `status.HTTP_305_USE_PROXY`
- `status.HTTP_306_RESERVED`
- `status.HTTP_307_TEMPORARY_REDIRECT`
- `status.HTTP_308_PERMANENT_REDIRECT`

### 4xx 客户端错误

- `status.HTTP_400_BAD_REQUEST`
- `status.HTTP_401_UNAUTHORIZED`
- `status.HTTP_402_PAYMENT_REQUIRED`
- `status.HTTP_403_FORBIDDEN`
- `status.HTTP_404_NOT_FOUND`
- `status.HTTP_405_METHOD_NOT_ALLOWED`
- `status.HTTP_406_NOT_ACCEPTABLE`
- `status.HTTP_407_PROXY_AUTHENTICATION_REQUIRED`
- `status.HTTP_408_REQUEST_TIMEOUT`
- `status.HTTP_409_CONFLICT`
- `status.HTTP_410_GONE`
- `status.HTTP_411_LENGTH_REQUIRED`
- `status.HTTP_412_PRECONDITION_FAILED`
- `status.HTTP_413_PAYLOAD_TOO_LARGE`
- `status.HTTP_414_URI_TOO_LONG`
- `status.HTTP_415_UNSUPPORTED_MEDIA_TYPE`
- `status.HTTP_416_RANGE_NOT_SATISFIABLE`
- `status.HTTP_417_EXPECTATION_FAILED`
- `status.HTTP_418_IM_A_TEAPOT`
- `status.HTTP_421_MISDIRECTED_REQUEST`
- `status.HTTP_422_UNPROCESSABLE_ENTITY`
- `status.HTTP_423_LOCKED`
- `status.HTTP_424_FAILED_DEPENDENCY`
- `status.HTTP_425_TOO_EARLY`
- `status.HTTP_426_UPGRADE_REQUIRED`
- `status.HTTP_428_PRECONDITION_REQUIRED`
- `status.HTTP_429_TOO_MANY_REQUESTS`
- `status.HTTP_431_REQUEST_HEADER_FIELDS_TOO_LARGE`
- `status.HTTP_451_UNAVAILABLE_FOR_LEGAL_REASONS`

### 5xx 服务器错误

- `status.HTTP_500_INTERNAL_SERVER_ERROR`
- `status.HTTP_501_NOT_IMPLEMENTED`
- `status.HTTP_502_BAD_GATEWAY`
- `status.HTTP_503_SERVICE_UNAVAILABLE`
- `status.HTTP_504_GATEWAY_TIMEOUT`
- `status.HTTP_505_HTTP_VERSION_NOT_SUPPORTED`
- `status.HTTP_506_VARIANT_ALSO_NEGOTIATES`
- `status.HTTP_507_INSUFFICIENT_STORAGE`
- `status.HTTP_508_LOOP_DETECTED`
- `status.HTTP_510_NOT_EXTENDED`
- `status.HTTP_511_NETWORK_AUTHENTICATION_REQUIRED`

## 技巧

在大多数情况下，你只需要记住最常见的：

- **200** - OK（默认）
- **201** - Created（创建资源时）
- **204** - No Content（删除操作，没有内容返回）
- **400** - Bad Request（客户端错误）
- **401** - Unauthorized（未授权）
- **403** - Forbidden（禁止访问）
- **404** - Not Found（未找到）
- **422** - Unprocessable Entity（验证错误）
- **500** - Internal Server Error（服务器错误）

## 警告

请记住：

- 状态码应该是数字，如 `200` 或 `404`
- 使用 `fastapi.status` 的常量而不是硬编码数字
- 状态码应该符合 HTTP 语义和 REST 原则
